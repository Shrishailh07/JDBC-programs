package com.xworkz.jdbcdemo;

import java.net.ConnectException;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.Scanner;

public class Runner {

	public static void main(String[] args) {
		insertmovie();
		updatemovie();
	}

	private static void insertmovie() {
		Statement statement = null;
		Connection connection = null;
		//step 1
		// load and register the driver

		try {
			Class.forName("com.mysql.cj.jdbc.Driver");
			System.out.println("class loaded");
			
			//step 2
			// create connection (Establish connection with mysql server)
			
			connection = DriverManager.getConnection("jdbc:mysql://localhost:3306/jan06","root","root");
			System.out.println("Connection created");
			
			//step 3
			//create a platform/environment to execute the queries
			statement = connection.createStatement();
			System.out.println("Statement created");
			
			//step 4
			//execute the query
			statement.execute("insert into movie values('KGF 2',3,'kannada',1000,10)");
		} catch (ClassNotFoundException | SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} finally {
			//step 6
			//close the costly resource
			try {
				if(statement!=null)
					statement.close();
				if(connection!=null)
					connection.close();
				
			} catch(Exception e2) {
				e2.printStackTrace();
		}
		}
		
		
	}
		
		private static void updatemovie() {
			Statement statement = null;
			Connection connection = null;
			
			Scanner sc = new Scanner(System.in);
			
			System.out.println("Enter the movie name");
			String name = sc.next();
			
			System.out.println("Enter the id");
			int id = sc.nextInt();
			
			System.out.println("Ënter the Language");
			String lang = sc.next();
			
			System.out.println("Enter the budget");
			double budget = sc.nextDouble();
			
			System.out.println("Enter the rating");
			int rate = sc.nextInt();
			
			
			//step 1
			// load and register the driver

			try {
				Class.forName("com.mysql.cj.jdbc.Driver");
				System.out.println("class loaded");
				
				//step 2
				// create connection (Establish connection with mysql server)
				
				connection = DriverManager.getConnection("jdbc:mysql://localhost:3306/jan06","root","root");
				System.out.println("Connection created");
				
				//step 3
				//create a platform/environment to execute the queries
				statement = connection.createStatement();
				System.out.println("Statement created");
				
				//step 4
				//execute the query
		statement.execute("UPDATE movie SET name=(('"+name+"'),language=('"+lang+"'),budget=("+budget+"),rating=("+rate+")where id =("+id+"),");	
		System.out.println("movie updated");
			} catch (ClassNotFoundException | SQLException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			} finally {
				//step 6
				//close the costly resource
				try {
					if(statement!=null)
						statement.close();
					if(connection!=null)
						connection.close();
					
				} catch(Exception e2) {
					e2.printStackTrace();
			}
			
			
		}
	}
}

